package org.owl.y2024.d4;

import java.util.ArrayList;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.IntStream;
import org.apache.commons.lang3.StringUtils;

public class Year2024Day4Part1 {

  private static final String INPUT_MATRIX =
      """
XMMXMASAMSAAAXSXMASAMSMXSAMXMMMMXMSSSSXMAMSAMXMSXMMASAMXMMMMAXMXMSMSMXSXMXSMXXSAXXMSXSMXXXSASXSMMSSSMMXMAMSMSSSMXMAXXXXSSXXXXMXSXAXMASMMSASM
SAMXXAMXMAMAMMMAXSAXMAAMSMSXSAXMAMAAASAMXMSASAMMAMXAAASAMAASAMXXSAAAMMSAMASMMAMASMMSAMXSXMSASAAXAXMAMMAMAMAAAAAAAXSMMMMMMMMMXMAMXMAXXMAXSAMX
MAAAMSSMSASASASXMXMXSMSMXAAAXAXSAMMSMXXMSXSMMAMSAMMMMAMASXMMXMMMSMSASASAMASASAMAMAAMAMASXAMAMXMMMXSAMSMSASMMMSMMMXAAXAAAAAAXAMASAMAASMSMMXMX
SMMXXAAAMAXASAMSAXXXAMXMMMMMMAMSASAXMXSSMMXASAMMXMASMMMMMMAMXMAMXXXMMMXAMMSAMMMSMMMMXMASMSMAMAXAXAMXMAAXXMXMAXAAMSSMMSSSSSMSMSASMMSXMAMMXSSX
XXMMSMMMMSMMMXMMMMXAMMAMXMASXSXSAMXSMAMAAXMMMASMASMSAAXSASAMAXSSSMXSASMSMXMMMMAMAAAAXMMXAXMAXXXSMASXSSSXSXXMAMMMMAMXAAMXAXAAXMASXAMAMMMSAAXX
MXMAAXXXAAAXXMXSXMASXSASMMSMAAAMMMXAMXSSSMMAMXMMASASXMMSASMXSSMAAAASXSAMXMAMXMAMXMMAXSAMSMSSXSAXMAMMAAAAXXSMSSSMMMXMSSSMSMSMMSASMMMAMXAMMMMS
MXMXSSXMSSSMSMMMASAMASXMAXAMXMAMAMXXMXMAMMSAXSAMXSAMAMXMAMAAMAMSMMMMMMAMMXAMAMMSMSMXMAXSXAXAAMAMXSMMMMMXMASAAAAXXSAAMAXAAXMXMMAMASMSMMXXXAAM
MASAMXXXAAAAXAASXMXSASAMSSMSMSMMASXMMAMAMMMAMSASAMXMXMAMAMMMSAMXXAAAAXAMMSSMSSXAASAMXXSAMXMMMMASXMAXMAXAXAMMMSMMASXSMMMSMSXAAXXMSMMAAMXSSMSS
MAMASASMMSMMMSMSMSXMAMXXAAXAAXMSAXAXSASASAMMMMAMXXAXSXXSXSMASAMXSSSSMSASAXAAXMXMSMXXXMXXAXMSXMMSASXMSSSMMMSMMXAMXMMMASAMXSXMSMMXXXSSMMAMAMAM
MASXMAXSAAMSXMAMAMAMAMXMMSSMSMMMMXMMSAXXSXSASMMMSMMASAASAXMASAMXAXAAMSAMXSMMSAAXAXMMMMAMMMXSAMSMMMAXAMMXMAMAAMXSAMASAMAXAMMXAXMAMMXAXMASMMAS
MXXAMXMASMMSASAXSXMMASAAMAMXAAMAAAMXMSMMXASASAAAXAMASXMMAMMAMAMAMMMMMMXMASXAMXMSMMXAAXASXAAMAMAAXSXMMSMAMASMMSASASXSSSSMSSSSMMSASXSXMAXMXSAX
SSSSMSAMXMASAMMXXAXMASMXMASMSSSSSMSAAMXMMXMAMXMMMXMASAMXSMMAXSMMSASAXMSSXMMSSSMAXASXXSASMMMSAMMSMMAXMAXASMSXSMMXAMMSAXXAAAAXAASAMASMMXSXAMAS
XAAXASMXAMAMXMMAXAMXXMXSMXXXAMXMAAXMMMAMXMMSMSSSSSMXSAMAMXMXXMAAXASASMAMAMSXMASMMMSAAMMMAAASXSMXXXAXXMSXSASMSASMXMSMMMMMMSMMMMXAMAMAXASMMMXA
MMMMMXSSSSSMXSMXSSXXXAAXXSSMSMAMSMXSASMSAMXAAXAAAXMASAMASMSMAMMMMMMAMMAXAMXAXAMXAMMMMXMSSMMSAAAMMMMMMXMASAXAXAMXXMXAXXSAAMAMXMSAMXSSMAMAXXMA
ASXMMAXXAAXMMAMAXMASMMMSMMAAXXMMAXMSAXASAXSMSSMMMMMXMAMXXAAAAXAXAAMXMXMSMSSSMMMSAMXMSAMMAMAMAMAMXAAAMAMMMMMSMMMSSMSMMMMMMSAMAMMSMAMXAMSMMSAS
XAAAMMSMMMMXMAMXXSASAAAXASMMMAMSASMMSMMMSMAXAXMSXXMAXXMSMSMSMXMSXMSMMXMAMXAMXAXXSXMASXMSAMXSASASXMSXXAXAAAAXAXAXXAAAAAAAXSAMXSAAMASMSAAMAMXA
SSSMMMAAAXXAXSXSAMXSXMMSMMMASAMSSMAAAMAAASXMAXMXMAMMXMAAAAXXAMXMXASAAAMXSMMMSXSAMSSXMXMSAMXSASASAMAMSMMSSMSSXMASMMMSXSMSXSXSXMMMXASAXMXMASMM
AAAMAMSSMSSMSAXMMMMMASXXMMSAMMXXAXXSMSMXXMMXSXMAXXAASMSMSMSMMMAAAXSAMXSMMASXAAMAMAMAMMMXMSMSXMXSXMAXXSAXAAAAAXMAMAAXAXXMASAXAMXSMASAMXMXAMAX
MMMXAXXMAXMXAMMSAAASXXMMXAMMSSXSAMMMMAMXXSMAXASMSSMMSAXAAAAAAMMXMMMMAXAAMAMXMXSAMASXMASAMXAMXSAMXMSSXMSSMMMSSMSAMMSMMMMMMMSMAMAXMAMAMXAMSMMS
XMXSSXSMSMSXXXAXXXXXMMMSMMSMAAXAXXAASXSAASMXSAMAAXAXMMMSMXSSMMMAXXAMXMSMMASXXASASASXSXSMMMSMAMASAAAMAAAMXSXMXXMAMXAMXAAXSAAXAMXSMMXMMXMAAAXA
XAAXMASAMAAMSMSSXSSMAMAAASMMMSSMMSSMSAMMXMAMMAMMMMSMXSAXAMMAMASXSSSSSMAXXAMXSASXMAMMMAMAASAMXSASMMASMMMSAMAAXSMSMSSSSMSAMSSSMSAMXAASASXSSSMM
SMMSMAMAMMMSAAAAAAMSMMMMMMXXSAXAAXMMSASMSMSMSSMSMXXAMXSMXMSAMMAAAAXAAMAXSAXAXXXXMXMAMAMMMSASMMAXXMAXXSXMASMMMXAXMAXXAAMAAAMAMXXSMSMSAXMAMXXX
XSAXMASMMMMSMSMMMMXSMMXSAMXSMMSMMMMXSAMAAAXAAMAXSAMAMSMSXAMXMAMMMMMXMMAXSXMAXXMXMASMSMSMXSAMAMMMASASMXASAMXXAMSMMMSSSXSMMXSXMASMMMAMAMMXSAMX
SMMMXXXMAMXMXXAXXXMXAAAAXAMXAXSXMMSAMAMSMSMMAMMMMMSAMXASMMMSMMXXAXMXAMXXMXAMSMSASMMAAAMAMXMSMMAMMAAAAMXMSSSMMXMAMXAAXMXMMMXXMXMAAMXMMMXAMASA
AMAAXSSSSSXSAMMMMXAXMMSSMMMSMMSAMAMXSXMMMXXSAAAXAXMASMMMASXSAXMMMSSMSMSASMSMSAAASXSSMSMSMMXSXSASAMMMSMMAXMAMXAMAMMMSMSASASMSSSSSMSSSXSXMSAMM
MMMXSAAAAXAMMSSSMXSAAAAAMXAAMASAMMXMMXXXAMASMSASMSXAMAXSXMASXXAASXMAAASAXAMXMXMMMAAAXXMAAAAMMMASMMMAMAMMMSXSXXXASMMAAXASXSAMXAAXSAXMASAMMXMX
XMAMMMMMMMMSAMAAAAASMMSMAMSSSMSMMSSMMASAAMAMMMMAASMMXSMMAMMMAMSMSAMMMMMXMSMAMXMMXASMMASMSMXSXMAMXSMAMMMSAMXMASXMMAMMSMMXXMMMMMMMMXAMXMASASXM
MASXAXSXXMASMMMMMMXMMAXXSXAAAAMXAAMAMASXMMXSASXMMXAMAXASMMSMAMAAXXMASMMSAASAMAMMMMMXSXMXXMMSMMMSASMMMSAMAXAMXMASMMMAXAXMASAMAAAXXMXMXMSXXMAM
SAMMXSAMXMMSXMSSMXSSXXMAMMSSXMXMMMSAMXSAMXXMASXMMSSMMMAMXAAMMSMSMMSASAXMSXSMSMSAAASASAMXMMXXAAAMMSASMMMSASXMSSMMSAMASMSAMMASXSXSMASMMMMSMSXM
MASXMXMASMXXMMAAMAAXMXMASAXAXSAMSASASAMAXMMMXMXXAAAAXMXMMSSMMAAAMAMXMXAMAMSAAASAXXXMMAMAMSMSMMMSAMMMAAMXMAXXMAMAMXSAAAMMMSAMXMASAMXAAAAXMAAX
MAMXAAXXAMXMMMSSMMMSAMSMMMMSMMASMXXMMAMAMSAMXMMMMSSMMSMAXAXAXMXMSMMSMMSAXAMMMXMASXSSSMMAMAAXAMXMAMASMMMAXASMSAMXXAAMMXMAXMAMMMAMAXAMSMSSXSSM
MASXSXSAASXAAAXAXXAXMASXMAXAXMSMMAMSSXMSXSASMSAAXAAAAXMXMMSSMAAXXXAAXAXMMMMXMSMMMAAMASXSSMSMASMMMSASXXSAMXSASXMAMXSSXMMMXMAMAMSSMMXXAAXMAMXX
SXMAXAMMMMMSMSSSMMMSXASXSXSSMMMAMXMAAAMXASXMASXSSSSMMSXSAAAAMMMSAMSSMSSXSSMAMXASMMMMAMXAAAMXXMAAAMXMAASAMMMAMAMAXSAMMSAAMMSSMMAAMXSMMXMMXMAX
XAAAMAMAMAXAMXMMAMXMMXSXMAMAASMSMAMXSMMMAMAMXMAXMMXAXAASMMSSSMMXXXXXAXXAAXSAMXXMASXMMSMSMMMAMSMMMSAMXMSAMXMASXMAXMAMAMMMSAMAMMXSMASXXAAMXMSS
XXMSMMSXSXSXMAXSAMAXMASMSAMXMMAAAMMAMAXMMMXMMMSMMXSMMMMMXMAAAAMMMSMMSMMMMMSMXXSXXMMMAAAXMMMSMAAAXSXSAAXXMXMASASXXSMMXSAAMASAMMAMMMXASXMMASXA
MSXMAAMMSAMMSXXMMSMMSAMXSASXSMSMSXMAXMXASXXXAAAAXXMMASXSAMMSSMMAAAASAMXMXXMASXXMAXAMMMMXXAAAMSXMXSASMSMSMSMXSXMXMAAASMMMSXMXSMAMASMAMAASXMMM
AXAXMMMAMAMASMMXAAAAMASASXMASAMAMMSSSMSAMXMSMSMSMSAAXXASASXAXMXMSSSMMSASMSMAMXAXAXSXMXSMSMSSMMSXXMAMAAAAAAMMSXMXAMMMXXAAXASXXMMXAMMMMXMMAMSX
XMMMSMMMSAMASAMSSMSMSMMASAMXMMMAMMAAAXSAMXXSAMXMASMMSMAMAMMMMXAMXMXAASASASMMSSMMSXXAXAAXXXAXAAAMAMXMXMSMSMMAXAMASXSAXSMSMAMXXSSMSMSASMAMAMAA
MAAASAMXSXMXMAXMAMXAAXXAXMMMMMSMSMMSMMMASASMAMAMAMMAMMAMMMMXAXASMSMMMSAMXMAMAAAAMASAMSSMMMSSMMSAMXXSXMXAAAMSSXMAMMSAMXAAMAMXMXAAAAXAXXAMMMMS
ASMMXAMAXXAXXSXXXMMMMSMSSSXXAAAAAXAMMSSXMXXMAMMMMMMMSSSSXAMXSAAAAAAAAXAMXSXMSSMMSAMXMAAASAAXXAAMXMMMASMSMMXMAMSXSAMMMSMMXAMXXAMMMSMSMSSXSAAM
XXSMXSMMSSMXMAMSMSMSAXAXAMXSMSXSMMXSAAXXMASMXSAAASAMAXAAMSMAMMMMSSMMXSMMXMAXAAMAMMMXMSSMMMMSMMSXSXASXMAXXSAMXMMAMMMAXAASXSSMSXSAXAAAAXAASMMS
SXMXAXAMXMASMXMAAAAMMMSMMMAMMAAMXMAMMMSMSAXMASMSMSASMMMMMXMMSXMXMAASAMAAMXMMMSMAMASAMXAXXXXSAMXAXSMSMMXMXXMXMSMXMASMSSXMAAAAAAXXSMSMSMMMMAXM
SAMMMMAMMMAMXMSMMMXMASXAAMMSMMSMAMMSMXAAMXSXXXAXAXMMXSAXXXSXMASASMMMASAMXASXMAMXSASASMSMMMMSAMMXMMXMXMAXSSSSMAAASXSAMXMXMSMMMSMAMAAXAXXASXMS
SAMASXMMXMASXMAMMXSMMMMSMSAAAMXMSMMAXSMXMASMMMSMSSSMAXMMMXMASASMSAASAMXSSXSAMASMMASAMXAAMSASAMMMSMAXXSXSXAAASMSMSAMMMASAAAMXAAMAMSMSSXSXSAAA
SAMAMAXSAMMSMSAXXAMAXAAXXSMSSMAXMASMMMSAMXSAAXAAXAAMXMXAMAMXMXSXSXMMXSAXXMSMMASAMMMXMXSXMAXXAXXAASMMMMSAMMSMMMXXMMMXSASMSMSMSMSXMMAXMASMXMSM
SXMMMSMSASASXSMSMASXMMMSASAMXMAMSAMXAAAXAASMMSMSMSMMXMSSMXMAMXMMMXXXXMXSSMMAMAMXMAMMSAMXXMASMMMMMASAXXAXMMAXAMXXMAMAMMSXXAXXMXMMMMXMMMMAMXAX
MMMXAMMMXMASAMAXMAMAMSAMXMXMXAMMMSSXMXMXMAXXXXAAXMASAAAAMSSMSXXAXSMMXSAMXASXMMSASMSMMASMSXMAAASXSASXSMMSSXMSSSSSSSSXSASMMMMMMXSAMMMMAXASAXMS
MXSMMSASAMXMAMSMMSSMMMXXMXXMAXAXAXMASAMXSAMSXSSMXSASMMMSMAAXAXSMMSAMXSAMSMMSAMXXMASASAMXAAXXSMMAMASMMAXAXAXAXAAAAAAASAMXAXAAXMASAAASASMMSSXM
XAXAMXXAMXAMAMAAXAAASXSMSAAXMASMXMSAMASXMAXSAMXSAMXXXMAXMXSMMAXMAMAMXXAXXAAMMMXAMAMXMASXMMMAMAMSMAMMSAMXSSMMSMMMMMMMMAAMMMSXMXMASMMSAMAAAMAA
MMSSMXXXXSXSASXSMMSMSAMASMSMMMMAXMASXXMXMMAMXMAMXSXSAMXXSAMAXMSMAMSMSSSMSMMSMMXSMXMXXMXMAASXMAMXMSSMSASXMMAXMAMXXSAMSSMXSAXASMXMAXAMXMSMSXSM
MAAAXMMMMMMMASAXAXXXMAMMMXAAASMSMSAMXAMMSAMAMMMSAMXAMMXXMASXAASMMXMAMXMAXMASAAAXMMMSSMASXMSAMSMMXMAMSAMXMSSMSMSMXMAXMAMXMASAMAASMSXMSMMAXAAS
MSSSMSAAAAASMMXMASXXSAMXXMMSMXAAAMASXSMAXAXXMAMXAASXSMSMSMMMMXMAMAMAMSMMMMMXMMXMASAAAMAMAAMMAMXMASAMMAMMXAXAAAAMASXMSAMSMAMASMXAAXMXAAMAMMMM
MXAAASXSXMMMAMXMAMXAXXSAMXMAXMSMSMMMXAMMSXMXMSSSSMMAAASASMAXMAXAMASXMXMASMSXSAXMXMASMSMSMXMMAXASXSSSXSAMXAMSMSMMAMXASXMASXSAMXMMMMMSSSMSSXMS
SMSMMMXMXSSSSMAMXSSMSASAMXMAXXAMXAXXSXMASMMAXXAAXAMSMMMAMMAMSXSASASMMASMSAAAAAMSSSXMAAAAXSXMMSMMMXAXAMMAMXMXAAXMMSMMMSXMXMMMSXMAAAAXAXAAXAAX
XAAAAXMMAAAAXMXSAAAAMAMXMMMSMMSXMAMMMAMXSASMSMSMSAMXAXMMSAXXAAAXMMSXXAXAMXMMMSMAAAAMSMMMMMXSAAAAAMMMXMASXSSMSMXMMAAAAMXXMXAXMASASXSMAMMMSMMS
MSMSXMAMMMMMMMASMSMXMAMSXMAXASAXSASXSASMXMAAAAAMSMMXXXXAMXXMMSMMMAMXMSSMSMSXXXMMXMXMXXXAXXAMMSMMSAXAMXXMAMXAXXASMMSMASMMAMMSSMMXXAMMXMAMXAAS
AXAXMMXXXXAMAMASAMXXMAXSAMXMXMAXSAAAMAMAXSMXXSSXSAXSMMMSSMMMAAMSXMXAAAAAMASAMXSASMMSMSSSSMASXMMMMMXSSSMMAMSMMXAXAMAMXAAXSAAMAMMXMMMMSAMSMMMS
SMAMAASMMSMSAMAXMSMMSMMSAMSSSMMMMMMSMSMMXXXXMAXASMMXAAAXAAMMXSAMAXSMMSMMMMMAXAMXAMXAAAXAXMASAMXASAXXAAAXXXAMMXSSXMAMMXSMMMMSAMXAMSAMXAXMAMXX
AMXMXMAAAAASMMMXSAXMAMAMAMXAAAASXMXXAXAXSAMSMAMMMXSSSMSSSSMXAMASXMXAAMMMSSSXMXSSSSSMSMMMMXAMAMSASMMMSMMMSSMSSMAAAMXMSMMAXXAMASXMMSXMMAMSSMSA
MSMMASMMMMXMAAXXSAXSAXAMMMMMMMMSAMXMAMMMXAMXMAMXMAXMXAMXAAMMXSAMMMMMMMAAXMXASXXAAAMXAAMXAXXSSMMXMAMAAXAAXAXAXMASMMMAAAMXMMMSMMASAMMSMSMAAAXS
XAASASXSASAXSMSMMSMSSSMXMASXSAXSMMMSAAAMSSMXMASXMSSMMSMMSMMSMMASAAMSMSMMSMSAMXMMMMMSSSMXMAAXXXXMSAMSSSMSSMMMSSXXMXASMXMAXAXAXMAMASAAAAASMMMM
XXXMXXXSASXXAXXAAMMSASAASAMASAXXSAASXXAXAMAMXAMAXAAMAXAAXXMAASAXXXMAAAASAXAASXSAAAXMXMMAMSMMMSMAMXMMAXXAAXXAAXMAMXMMXAMSXMSAXSASMMXMSMXXSAAM
XSAMMSMMMMXAMXMMMXMMAMMMMASXMMMMMMMSMMSMASXSASMSMSSMSSMMMASMMXASXSSMSMMMXSMXMAMASXSMSSMMMAAAAMMMMXMMXMASMMMMSXSAMXSSSMSAAMMMMSASMSAMXXXASMMS
XAAAASXMASXXXAXAMASMSMSXSAMXSXMXAMASMAMMMMXSAMAXAAAMXMMAMAMXMXMAXXAAAMASAMXAMXMAMMXXAMASXXSMSSXMASXMAMXMMMSXMXSASXSAAXXMXMASAMAMASMSMSMMMSMA
XSMMASASXMXXSSSMSMSAMAAXMAMAXAMSXSAMMASAMXAMAMXMMMSSSMSSSMSXAXXXXSMMMSASASMMSAMASXMMASAMXMAAAMAXXAMSSMXMASMAMMSAMXMMMXASXSXMXSXMAMXMAAMAAAXM
MXAXAXXMAMMMAAXAAXMAMMMXXSMMSSMAXMASMASAMMXXAMASXXAAAAAAAAAMMSMMXMASXMXSAMMMMASXSMMAXMAXSAMMASMMMMAXMXAMMMMAMAMMMXXAXMXMAMMSAMMMXSSMSMSMSSSX
AMSMSSSMXSAAMMMSMSSXMASAAXSMAXMASMMXMMSXMASMASASXMMSMMMSMMMXAAAXXSASAMAMMMAAMAMXXMASXAMASMXXXAMXAMMMMSMSSXSASMASXXMAXAAMAMAMASXXMXAAAAMAMXAX
SSXAMAXXASMSXXXAMAAASASMSMAMXMAMXAAXMAXAMAXSAMMSAMAXMAMXXXXMSMSMAMAXMMASASMSSSMMMMMXAASAMXMXMSSSSXSAMXMAXXMAXXAASASXSSXSAMXSMMMSAMMSMMMSMMSA
XAMXMSMMASXMMMXAMMSMMASXMMAMMMSMSMMSMMSAMXMMXSXSMMSSMMXMXMAXMAMMSMSMASMSASMMAXMAAAXXSXMASASXAAMXAASXMAMXMMXSXSSMMXAAAAAAAXAMXAXASXXAAAXXAAAM
MMXMAMAMXXMMAMMMMXXXMXMXMSMSAAAAMAAXAAXAXXMSMMAMXMXAXMASAMMXMXXAAAASAMXMMMAMAMXMMXXXMXXMXAMMMMMMMMMASXMSAMAMMMAXMMMMMMSMMMSMSMSMXMMSXMSMMMMX
AXMAMXXMMSMXXMMSAMXMSASAXMASMSXSSMMSMAMMMSXAXMAMSSMMMSXSAXMAXMMSMSMMMSAMASXMASXSSSMAASXMMSMMSSSXMXSXMAASAMXSASMMXAXAAXMAMMAAAAAXAAMAMSMMASXM
SMSSXSASAXMASMXMASMXSASXSMAMXMXAAXXMASXAAXMMSXSXSAMSMMASXMSXXAMAXAXAASASMSXMXAXAAMXXAMXMAAAMAXMAXAXAMXMSXMXSXSXMSMSMSMSAMXMSMSSSMMMAMAAMASAS
XAAAASAMSSMASMAXSMMAMXMAMMMXASMMMSSMAXSMXSAXMAMXMMMAAMAMAMAASMMMSMSMMSXMAMXSMMMMMMSSSSMMMSXMMSSMMSSXMMXMMSXSAXMAXAAMAASMSXAMAAMAXSSSSSSMASXM
MMMSMMAMAXMAXMAMXAMXMASAMSSMMSAXAXAMAMAMASMSMAMASASXSMASAMMMMMAMXXXXASAMXMAXAXMASAMAAAXSXXXAXAAAAXAAXSASMAAMSMMAMXMSSXMAMMMMMMXAMXAMAAXMMMAM
XMXMXSXMXSXSSMSMMAMXSASAXAASASMMSSXMSSXMAMMAMAMXXAXAAMASMMXAMSXMMMSMMMXSXMASMMSASAMMMMMXAXSMMXSMMSSMMSASAMMMMXMMSAAXXASXMAAAXAMSSMMMXMASMSSM
XAAXAMASMMXXAMXMMMMXMMSXMXSMXMMAXAASXSAMSXSASXSSMSMSMMXSMMSAMAMXAAAAASMMASXSXAMXSXMASAXMMMXMAXXMMXAXXMAMMXXAXXXAXMSMSMMASMSSMMSAAAXSAXXAXAMX
MMSSMSXMASXMMMSXASMSMAMMSMMMAMXSMSMMASMMMAMXSAMXAMAMXSXXAASMMAMSMMSSMXAXAMMMMMSMMASXMXXAASXMXSMASMMMXMXMAXSAMSAMXXAASXSMMXAMMMMXMMMMMSMMMMSS
XXAAXXASMMSAAAXXASAAMMSAMASMMXMXMXAMMMMAMXMASASMMMSMAMAMMMSMMAMXAAMAMSMMAXASAXAXMMMXSMSSMSAAASMMMAXSMXSAXXMAMAAXAMMXMXMAMXMASAASXSXSAAAAXMAX
MMSSMXMMAASMMMSAMMMMMXMXSAMXSAMASMMXSXMASAMXMMMAAAAMMSSMSXXASMSMMMSAMAMMXSASXSMMSAMMAAXMAXMMMMAXMMMXAAMAMXMAMMMMMMMXMXSSMXXASMSMMSAMSSSMSMAS
XAMAXSMMMMSMSAMAMSSXAXSAMASAXASAMASAMAXAXASXAASXMSSSXAAASMMAMAAXSMSAMXSAAMMMMXAAMASAMMSMSMXMSSMMSAAMMMXAAMSSSXSXSASMSAAAMXMASXAMAMAMAMAMMMMS
MSSMMAAAMSXXMAMMMASMMMAAXAMMMMMMSXMASAMSSMMXSXSAAAAXMMMMMASMMSMMMMMAMAMMXMXAMMMMSAMMXMSAMXMAAAXASXXXMSXMSMAMAAXAMAXAMMXMMMMXMASMSSXMASAMXMSX
XMAMMXMMSAMMSSMMMASMAASMMSMSMSAXMMSAMXSAAAAMMMMMMMSMMXSXSMMAAMXMAASAMXMXAMMMSAAXMXMMMAMXMMSMXXMASMSAMXASXMMSMSMSMXMSMXAXAAMAMXXAMXMXASMSAMXM
SAMASAASMMAAAXAAMMSXSXMMXXAAAMMMSMXMXMAXSMMSAAXSAMXAXXXASASMMSASXXSMSXMMASAASMSSMSSSMXAXMAMMSMMAXMASMSMMAXMAMAAMMXXXASMSSXSASMMMMAMMMSASXSAA
MAMASXSMMXMAXSSMSAMAMMAMAMSMMXAAAXMMMSAXXXAMXMXSASXSMAMXSMMMAMMSMAXXMAMSASMXMAAAAAAAXMASMMXAAAMAXXAMXAMSMMSXSMSMASXMAMAAAAMASXAMMSSSMMAMAMXS
XAMMXMXAXMAMMAMAXMMAMMAMAMXMSXMMXMAAAMXSMMMSSMMSAMAAMXSXMAMMAMASXMSMSAMMXMMXXXSMMMSMMMAXXMMSSSMSXMMSXXXAMXSAXMMMAMMAXMMMXMMAMMSMAAMAXMAMAMMX
SMSSMMSAMXAXMAMASXSAXSASMSAMMXSXMASMSSMMAAAAMAAMAMSMMAXAAAMSMSAMAXAAMASXAMSMMMMXAMAMAMXSXMAMAAAAMSXSAXMAXAMXMXMMXMAXMXXMSAMMMAXMMSSMMSMSMXAX
AXAAAXXMMMSMSXMXAAXAMXMSASAMXAMSSMXAAMAXXMSMSMMMXMAXMMSMMXMAAMXMASMSMXMXXSAMXAXXMXAMXSSMMMSSSMXMAMASASMXMASAMAMXMMSMSXAXAMXSMMSXXMAMMAMAAASX
MMSSMMSASAMXSAMXMSMMMAXMAMAXXXXAMXMMMSMMXMMXMXMSMSMSAAMAAXMMMXMAXXAXMAMXXMXSMSXSSSSMXSAAAAMXAXSXSMAMAMAASAMMSAXXXAAAMXSAMXASASXXMXSMSASMSMMA
XAXAAASXMASXMAMSAAAXSSSMSMASMMMSSMXXMAXAAMSASASAAAAMMMSMSSXXSAMXSMXMSSSMSXAMAXAAAAAMMSSMMSSSMMMMXMASMMSMMAXXAAMSMMMSXAXAXMSSXMMMMAMASASAMXXX
MSSMMMXAXAMASAAXSMSMMAAAXMASAAXAAAXAXAAXAXAAMMSMSMSMAXAAMXAXSASXSAAAXXAAXMMMAMMMMMMAMXXMAMXXAAMXSMXXXMXSXMASMSMAAAAMMMSSXMAMMAASMAMAMSMXMASM
MXXXAXSSMASXMMSMXMAMMSMMMMASMMMSSMAMMSMMSMMSMXXMXAXXAXMXMMAMMAMMSXSSSXMMMMXMASMXMXXXMAMSSMSMSMSXMXMASMAMXXXAAXMXMMMSAXXMMMMSMSASMSMSMAMSSXMA
SMMMMMAMMMMAXAXMASAMXXXMAMAXAMAXAMAXAXXAXAAMXXSXMSMMAMSAAXMMMAMMMAMMMAASAMXMXXXAMXMXMXMAMXXAAAMMSAMSMMXSAMSMMMSMMAAXXMAMXMMAAXASAMAASMSAMASM
MAAXMAXAAAMSMSXSASASMMMMSMSMSMXSAXXMMSMSSMMSMSMAAMAMAAXXXMSXSXSAMXMAXSMSXSMSXSSXMAMASAMMSMMSMSMASASMXMXMAMAAAAAAMMSSMMAMAMMMSMMMAMSMSXMASAMX
SSMSSSMSSXXAAMASASAMAAAXMAMAXXMSAMSAMSMMXXXAMAXXMSXMMSSSMAAAASAMXAMSMXASAXAAAMMASASXSAXXAAXXSXMXSMMAASMSMSMMMSSSMMAAXSASASXXAAXSMMMXMXSAMASX
AMAAAAAMAMSMSMAMAMXMMMSSMAMAMAAMAMSAXSASMMSXSMSMMXAXXAAAMXMMMSSXXMAXAMAMXMSMMASXSMSAMAMSMSSSMMSASAMSMXAAMMMMAXMAAMMSMSASASXSASXXMAMXMXMASXMX
MMMMSMMMAMAAXMXMASASASXAMXSASMMXMMSAMXAMAMMAAAAXMAMMMMMMMASXAXMMMMAMAMXMMXXXSAMXSAMXMAMSAMXAASMMSAMMAMSMMAAMSMSSMMXAAMAMAMASMMMXMAXMSAMXMAMX
XAAMXXMSXMMSMSXSXSASXAXMMMSAXAAXSASMSMXMXAMSMSMXSAMAXXXSSXSMXXMMSMASAMXSAMMMMASAMAMXMSMXASXMMMAXSXMSMXAAASXSAAXAXMSMXMXSAMXMAXAMSMSASMSMMSXM
SSMSAMMXSAAMAMAXXMXMMMSMSMMMMMXXMASAMMMMSMMAAAMASASXSMXMAXSMMSMAAXAXAMAXMASASXMXSAMMMMMSAMMSXSAMXXMAMSXSMMXSMMMMAXAAXSAMASXSSMMXAAAXSAMXAAAX
AMAMASMASMSMAMXXXMASAXAAASAAAAMSMMMAMMAAAASXSAMXSAXAAXMASMMAAAMSMSSXXSMSMMSASMMASXSAAMXMASAAMMSMSXSAMSXXASAXMASXMSMSMMASXMASAAMSSSMMXMXMASXM
XMMMAAMAMXAMXXSSMSASMSMSMSSSMXSAAMSAMXSMSMMMMMMMMXMSMMMAMASMMSAMXAMXAAAAMXMMMAMMSAXMSMXXSMMXSAAMAASMXMASAMMSXXMAXXAAASAMMSSXMSMAMAXXAMMMMMMA
XSXMSSMMSMMSSXAAAAXSAMAMXMXMAXSMMMSASAMAMMXAAAAAXAAMXSMXSAMXMAMAMASMSMSMSAXAMAMSMXMXXAMMXASMMXSSMMMSAMXMMMXMXMMXXASXXMMSAXAMXMMXMAMMAMAAAAMS
MMXMAMASAXSAMSMMXMSMMMAMMSMMSMMMXAXMMXMAMASXSSSSSMMXAXAMMXMMXXSXSSXAAXMASMSMSXSAAASMMASASAMXSAMXAAAXXXSMXMAMMSMSMMXSAMXSMMSAMXSSMSMXMASMSMSM
MXXSASMMAXMAMSXMMXMMXXASXMAAXAXXMSXXAXMAMMMAAAXAAMAMSMSMAAMMMXMXMXMXMSMMSXSXAXXMSMXASAMXXAXAMXSSSMMSMMXMAXMXAMXAAMAMXSAMAXAMAAAXAAMSSMXAXXSM
SAMMAMMMXMSMMMAXSASASXAXASMMSMMMMXAMXSSXSXMMMMMSMMASAAXMMXXAAAXXMASXMAMSMAMXMSMXMXSXMMSXSSMXSAMMXMAAXAAXSMSMASXSXMASAMASMMSSMSSMMMSAAXMAMASX
MASMMMXMAMAAAMMMSASAMXXSXMXAXAAAAMAMAAMAXMXMAXMXMMXSMSMSASXSSMXASASASXSMMAMAAAMAMAXMASAAAXAAXASAAMMSMSMMMAASXMAXXSMSXSAMXAXAAAMAXXMMSMMMMSMS
XAMMASASASXMMMSAMMMAMMMMMMMMMMSMXSAMXSMMMAASXSXAMSAMXXXMASAAAXSAMASAMXMMSMSMMSMSSSXSSMSMMSMMSSMMXXAAAXXAMSMMSMXMASAMMSAXMASMMMSSMXMAXAAASAMX
MSMSASXMASAASAMXSASXMXAAASAMMXMMMXAMAXASMMASAAMXMAAAASAMXMMMMMAMXXMMMMAAMXAMXXAMAMAXAAXMXXAXXMXMAMSSMMMSXXXAXMASXMASASXMAXXXAXAAMAMXMSMXSMXX
MAAMASAMSMXAMASMMXSASMSMMMASXAAAMSXMXMMMASXMMMASASMMXSXMMMSSXSASMSMAMMMSSSXSAMAMAMMMMMMMXSXMAXAXAAXAAAXXASMSMMXMAXXMMSXMSSSSSMXSSMSSMASAXMAX
MMMMXMASXAMXSAMASASAMAXMSSMMXMSMMAXSMSMMAMMAMXXMXMAMAXAMAMAAMXASAMXAXAMMAMMMMSXMSSXMASASMAXSMMMSMSSSSMSMXMAMAMSSSMMSAMAAAXAAAAAMAMAAXAMXAMMS
MSXSAMXAMAMXMMSAMMMAMAMAAAAAXXAMMMSMAAXMMMSAMMMMASAMXSMMSMMSMMMMAMAXSXSMAMASXMXSAAXSMSASMMMAAAAAAAAXMAAAMMAMAMMAMXXMASMMMSMSMMMSAMXSMSSMSAMX
ASAMMSXMAAAAXXMXSSSSMSSMSSMMSSMSSXAMSMSXAAMXMAASASASAAMAMSAAAAMSAMXAMXAMXSXSAMSMAMMSXMMMAXSMSMMSXMSXMSMSAMMSMMMXMMSSXMMSXAAAXAXXAMXAXAAAMMMM
AMXMAMAASMSMMSAMXAAAXAAXAMAAAAMAMSMMAAXMMMMSMMMMASAMXSXXSASMSSMMSMXASASXXSASMMAXAXAXXMXMMMSAMAXXAMXXXMMMMMMAMAMXAAASXAAMXMSMMASXSSMMMMSMMXAX
MMMXAXMMMAAMASASMMMMMSSMSSMMSSMAMMMSMMMMXSAAMSXMAMMMMMMMAXMXAMXAAMSMMAMMMSASMSXSAMMMXSAASAMXMXMSAMASMSASXMSMSXSSMMSSSMMSAMAMSMMMMAMXMXAAMSMS
XAASMXSAMSMMXSAMXXAAXXXAAMMAAAXXMAMMAAAAAMXMMAAMAXAAAAAMSMSXXMMXMAMAMAMAMMAMAMXMXAMAAMMSMASASXASXMASASASXMAAXAMMXMAMXMASMSXMAXAAXAMAXSMMMAAA
SMXSAAMMXXAXXMMMMXXAMMXMMSMMSSMXSAMXSMMMXXASXSXMXSSXSMXXAAXXSMSSSMSSMSSSMMAMAMXSASXMMMXXMXMAMMMMAMAMMMSMASMSMMMAAMXSXXXSXSXSMSXMSASAMXSAXXXM
XMAMMMMMSSMMMMAAASMSASMXSXMAXAAASXMAMXMASXMSAMXXXAAXMASXMSMAMAAAAAAAAXAMXXMSMAAXAMAMMSSMAMMSMMASXMASXMASAMMMMXAXXSMMMMMXAXAMXSAAMASXMAXMMMSX
XMASXMSAAAXSASMSXXAMAMAMSAMSSMMMSAMXSAMAMXXMAMASXMSMMAMAAMMXSAMSMMMMSMMMSMMXMMMSASXMAAAMASXMASMSXXMAXSAMXMAASMMSAXXAAASMMMXMAMMXMASAMXMSAAXM
MSASAAMMSMASASXXMMSMAMSMMAMAXAAAMAAMMMMSSMMXAMAXAAXAMAMMXMAAXAXXAXXSXAAAAMXXXAXMAMMMMXXSAMAXAMXSMMMAXMXMMSSXSAAMMMSXXMXAXASMMMMAMASMMAAMMXMM
XMASMMMMXAMXAMASXAAMXMXAXAMXSMMSSMMXXAAXAAASMMSSMMMSSMXXMMMMSSMSSMMAXMMSSSSMMSSMSMSSSMAMASMMMSAMAAXSAMMXAAMAMMMSAAMSMSSMXAXMSASAMXSMSMSXSAAA
MXMMXAXXXXXSAMXMMSSXSSSSMAMXMAAAXXSMSMSSSMMSXAXSMXAMAXXMAXAXXAMAAAMMSSMAAAASAXXAAAXAAMXMAAXAXMASMMSAAASMMSMMXMAMMXSAMMAMMSMASASXSAMAXAMASMSM
SAMXSXSMSMASXSXXMAMAAAAAXAMMSMMXSAXXXAAAAXAMMMMMMMMSAMXMSSSSXMMSSMMXAAXMMXMMSSMSMSMSMMXMMSSSMSMMAXAMMMSAMAAMXMXSAXSAMMAMXAAXMXMMMASMMAMXMAMA
MAXAMMMAAMAMXAMXMAXMMMMMSMSXASXAMMSAMXMSMMXSAMAXMXMMMXAAAAAAXXAXAXMMSSMXXAAXXXXMAXAAMAXXMMAXAAMMSSMXSXSXMSSMAMAAXXXAMSSMSAXMMXXASXSXMAMAMMMM
SSMASMXSMSMXSMAXMASMXSMXXAAMMMMMXAXMASMXAAASMXMSMMSAMMSSMMMXAXMSMMXXAXXAMSMMMXSMMMSMMXSAMXXMSMSAAAXSAMMXMAMMAMASMMSAMAXMAXXAXMXMMAXXMAXAXXMA
AASAMMAMXAMXAMAXMAMMAMASMXMSXAAXMASXMMXSMMXXAASAMASASAMAMMXSMAXAXMMSMSMSXXASXAMASAMXSMMMSMMAXAMMSMMXMAMAMAMSXSAXAAXAMXMSAXSSMAASMSMSXSSMSMSS
SAMXAMMXMMXAMXMSMXSMMMAXMMMXMXMXSSMAXMASXMAMSMSAMMSAMXXSMXAAXSSSMSAMXAAMAMAMAMSAMSMAAAAAAAMAMSMAAMAMXSSMSSXSAMASMMXSMXXMAXAAXSASAAASAXAMAAAA
XXXSMXSAMSSSXSSXXAAASMXSXAMAMSSMMASXMMASAMXXAMXAMAMAMXXXAMSSMMAXAMXSSMSMSMSMSXAXSAMXSMMMSXMSMMMMSSMSAMAMAMXMAMMAMXXXASXXMMSSMMAMMMMMXMASMSMM
SAMXSAMASAAMAMMAMSSMMXAMXMMXMAAASMMMMMASMMSSSSSMMXSXMXMMAMAAXMAMXSSMXXAAAXAAXMSXSXSAMASXMASAAXXMXAXMASXMMSSSSMXMAMMMAMXAAMXAMMAMXXMMXSAMMAXX
MAMAMXSMMXMMSMMSMAAAXXSXSMSMMSSMMXMASMAXAXAAXAAXSMMMSMASXMASMMMMMSAMMSMSMSMSMAXASMMMSAMAMXMMXMXASMMSAMXXAMMAMMAMAMMMXMSSMASAMSXMAAMAMXSAMXMX
SAMXSAMXAMXAAXXAMSMMSXMASAAAMMAAMXSSMMXSMMMSMSMMSAAAAAXAMXAMXMAAXMXMMAXAAAXAMMMAMASXMASXMMSAXMMMXAAMAXXMMSMAMMAXASAMXMAAXMMAAXAMSSMAMSXMXAXX
SXSAMMSMSSMSSSSMMXAXAAMMMSMSMSMMSAMASMAAAAXAAMMMSSMSSSMSSXAXAXXSSMSSSMXMSMMXSAMXMXMASAMAAAAMXSAXSMMSSXMASAMASMSSXMASAMSSMXSMMMXMAAXMMSAMXSAX
MMMXSASAMAAAMAAXASXASAMXMXXMAMXAMASAMMSMMMSMSMAMXAMAMAAMXMXSMSMMAMAAXMAMAMASMMMSXMXXMASXMSMXAAMMMMAAMXAXXMSMSAMAXXXAXMAXXAMAAAMMSMMXASAMAMMM
SAMXMASXXSMMMSMMXMMMMAMAASASXXMXSMMMSXMSMMAXAMAMSMMSSMMMAAMXAAAMAMMSMMMSAXMXAAAMAMSASXSXXXXSMMXAXMMSSXSMMMSAMXMASXMMMXMSMSSMMXXAMASMXSAMXSXA
SSSXSMMMMMAMAMSMAMAAAMSMSMAMXMAXXMAMSMAAXSMSSSMXAAAAAXSSMSAMXSSXSXMXXAXMMMXXXMMSAMSAMAMMXMASXXSASXAMXMMAMAMXMMMAMMAXSAMXXAAAAXSASAMXMSXMAMMX
MAXXXAASASXMASAXXSSSXXAMAMSMMMSMSSSMSMSMMXAAMAMSSSMSSMAAAMMXMXAAXSMAXXSASXXSASAMXMMMMAMMAMMMMXXMAXAXAASMMAXSMSMMSSMMSMXMXXXMMXAAMMMMMMAXMSSX
MSMMSSMSASXMXSAMMXMAXMXSAXAAXAAAXAXAMAAMMMMMSAMXXMMAMXXMMSXSMMMMMAMSSMSAMAASAMSAMXSASAMMASAXXXMXMAXSXXMXSMSSXAASXMXAXAAXSSXXSAMXMXSMASMSMAMX
XAAMAMAMXMXXXMAMXAXXSXMSXSSSMXXMMXMMMSMAAAXMMASMAXMASMXSAXXAAASASAMXAMMAMMMMXMMMAASMSAMSAXXSMXAXMAXSMSMXAMAMSMSMAMMXMXXXAAAXXMMMMAASASAAMAMM
SSXMAMXXMSMMMSXMSXMAMAXMMMMAMSSMMXAAAXMSSSXMXAAMSMMMSXAMAXXXMMXXSMMSAMMXMAXXMXASMMSAMAMMSMAMXASMMSSXAXMXMMAMMSXMAMMXSAMMSMMMXSXAMSXMMSXMSMSM
MASXMSMMMAAMAAAMXMASXMMSAMSSMAAAAXSMMSAXAXAXMMSAAAAASMXSAMMSMSXMMMASAMASMMMASXXSAAMXMASAXMSMAMMAXMMMSMMAMMMSMAXSAAMAMASAXASXAMMSMMASAMAXAAAM
SAMXAAAASMSMSSXMAXAXAMXSAXAAMSSMMMAAXMMMAMMSAMXMSSMMSAAMASAAAAXAXMASAMASAAXSXMASXMASMAMMSAAMMMSSMAASAASMSAAAMMMSSSXASAMXSAXMASAMXMASAMMSMSMS
MXSMSMSMSMMAMXMSXMMSMMXSXMSSMXAMXXSXMSAMXMASXSXMXAMXMMMSAMXMAMASAMXSAMSSMMMXAMAMMXXMASXAMMMSXXXASXSSXXXMAMSXSXXMAMMASMMXMAMSMXMAMXMSAMXXXXAX
""";

  public static void main(final String[] args) {
    final List<String> lines = INPUT_MATRIX.lines().toList();
    final List<String> columns = buildColumns(lines);
    final List<String> diagonals = buildDiagonals(lines, columns);

    final List<String> allElements = new ArrayList<>(lines);
    allElements.addAll(columns);
    allElements.addAll(diagonals);
    allElements.addAll(allElements.stream().map(StringUtils::reverse).toList());

    final int numberOfXMAS =
        allElements.stream().mapToInt(e -> StringUtils.countMatches(e, "XMAS")).sum();
    System.out.println("Number of XMAS is " + numberOfXMAS);
  }

  private static List<String> buildColumns(final List<String> lines) {
    return IntStream.range(0, lines.getFirst().length())
        .mapToObj(
            col ->
                lines.stream()
                    .map(line -> Character.toString(line.charAt(col)))
                    .collect(Collectors.joining()))
        .toList();
  }

  private static List<String> buildDiagonals(final List<String> lines, final List<String> columns) {
    final List<String> diagonals = new ArrayList<>();

    final int numberOfColumns = lines.getFirst().length();
    final int numberOfRows = columns.getFirst().length();

    for (int colIndex = 0; colIndex < numberOfColumns; colIndex++) {
      final StringBuilder diagonal = new StringBuilder();
      for (int row = 0, col = colIndex; row < numberOfRows && col < numberOfColumns; row++, col++) {
        diagonal.append(lines.get(row).charAt(col));
      }
      diagonals.add(diagonal.toString());
    }

    for (int startRow = 1; startRow < numberOfRows; startRow++) {
      final StringBuilder diagonal = new StringBuilder();
      for (int row = startRow, col = 0; row < numberOfRows && col < numberOfColumns; row++, col++) {
        diagonal.append(lines.get(row).charAt(col));
      }
      diagonals.add(diagonal.toString());
    }

    for (int colIndex = 0; colIndex < numberOfColumns; colIndex++) {
      final StringBuilder diagonal = new StringBuilder();
      for (int row = numberOfRows - 1, col = colIndex;
          row >= 0 && col < numberOfColumns;
          row--, col++) {
        diagonal.append(lines.get(row).charAt(col));
      }
      diagonals.add(diagonal.toString());
    }

    for (int startRow = numberOfRows - 2; startRow >= 0; startRow--) {
      final StringBuilder diagonal = new StringBuilder();
      for (int row = startRow, col = 0; row >= 0 && col < numberOfColumns; row--, col++) {
        diagonal.append(lines.get(row).charAt(col));
      }
      diagonals.add(diagonal.toString());
    }
    return diagonals;
  }
}
